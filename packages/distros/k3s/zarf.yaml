kind: ZarfInitConfig
metadata:
  name: "distro-k3s"
  description: "Used to establish a new Zarf cluster"
  architecture: amd64

components:
  - name: k3s-amd64
    import:
      path: common
      name: k3s
    only:
      archs:
        - amd64
    files:
      # Include the actual K3s binary
      - source: https://github.com/k3s-io/k3s/releases/download/v1.23.7+k3s1/k3s
        shasum: 7a1fccf1b544b0b55133f1e0b36a69d111479b3ce5fb66c0dd9a5036bd82d500
        target: /usr/sbin/k3s
        executable: true
      # Transfer the K3s images for containerd to pick them up
      - source: https://github.com/k3s-io/k3s/releases/download/v1.23.7+k3s1/k3s-airgap-images-amd64.tar.zst
        shasum: 7630c1ffff5c170d088913b1676713b7f589a3b5b045f4c2894de8ae5b7eaf08
        target: /var/lib/rancher/k3s/agent/images/k3s.tar.zst

  - name: k3s-arm64
    import:
      path: common
      name: k3s
    only:
      archs:
        - arm64
    files:
      # Include the actual K3s binary
      - source: https://github.com/k3s-io/k3s/releases/download/v1.23.7+k3s1/k3s-arm64
        shasum: 3b8a3ac496244fb621f727cd59fd8228fd2a2c902b14b0fb703bf9089c9dbc11
        target: /usr/sbin/k3s
        executable: true
      # Transfer the K3s images for containerd to pick them up
      - source: https://github.com/k3s-io/k3s/releases/download/v1.23.7+k3s1/k3s-airgap-images-arm64.tar.zst
        shasum: a7aff4631a58b0c2978495395568635fa9a1d03c56c9061de1a162407b620d83
        target: /var/lib/rancher/k3s/agent/images/k3s.tar.zst
